<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>AI Voicebot Demo</title>
  <style>
    body { font-family: Arial; padding: 25px; max-width: 750px; margin: auto; }
    button { padding: 12px 18px; margin: 6px; font-size: 16px; cursor: pointer; }
    .box { border: 1px solid #ccc; padding: 12px; margin-top: 12px; border-radius: 8px; }
  </style>
</head>
<body>

<h1>ðŸŽ¤ AI Voicebot Demo</h1>
<p>Press <b>Start</b>, ask a question, and the AI will respond using a real LLM (free, no token).</p>

<button id="start">ðŸŽ¤ Start</button>
<button id="stop">ðŸ›‘ Stop</button>

<div class="box"><b>You said:</b><div id="trans"></div></div>
<div class="box"><b>Bot says:</b><div id="bot"></div></div>

<script>
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
let rec;

const startBtn = document.getElementById("start");
const stopBtn = document.getElementById("stop");
const transDiv = document.getElementById("trans");
const botDiv = document.getElementById("bot");

if (SpeechRecognition) {
  rec = new SpeechRecognition();
  rec.lang = "en-US";
  rec.interimResults = false;

  rec.onresult = (e) => {
    const text = e.results[0][0].transcript;
    transDiv.textContent = text;
    askAI(text);
  };

  rec.onend = () => startBtn.disabled = false;
} else {
  alert("Your browser does not support voice input. Use Google Chrome.");
}

startBtn.onclick = () => { startBtn.disabled = true; rec.start(); };
stopBtn.onclick = () => { rec.stop(); startBtn.disabled = false; };

async function askAI(text) {
  botDiv.textContent = "Thinking...";

  const response = await fetch(
    "https://api-inference.huggingface.co/models/google/gemma-2b-it",
    {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({inputs: text})
    }
  );

  const data = await response.json();
  let reply = "Sorry, I couldn't answer.";

  try {
    reply = data[0].generated_text;
  } catch {}

  botDiv.textContent = reply;

  const speak = new SpeechSynthesisUtterance(reply);
  window.speechSynthesis.speak(speak);
}
</script>

</body>
</html>
